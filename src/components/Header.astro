---
import HeaderLink from './HeaderLink.astro'
import UofTLogo from './icons/UofTLogo.astro'
import { Icon } from 'astro-icon/components'
---

<header x-data="{ isOpen: false, isResourcesOpen: false }" class="sticky top-0 z-50 bg-white shadow-md">
	<nav class="flex items-center justify-between p-2">
		<div class="flex items-center gap-2">
			<div class="logo">
				<a href="/" aria-label="Go to UofT FoM GRC homepage">
					<UofTLogo class="h-12 w-12 text-slate-700" />
				</a>
			</div>
			<h2 class="text-2xl font-bold text-slate-700"><a href="/">UofT FoM GRC</a></h2>
		</div>

		<!-- Desktop menu -->
		<div class="hidden space-x-4 md:flex">
			<HeaderLink
				href="/"
				class="hover:border-accent border-b-4 border-transparent px-1 py-2 text-xl text-slate-800 transition-all duration-100"
				>Home</HeaderLink
			>
			<HeaderLink
				href="/blog"
				class="hover:border-accent border-b-4 border-transparent px-1 py-2 text-xl text-slate-800 transition-all duration-100"
				>Blog</HeaderLink
			>
			<HeaderLink
				href="/about"
				class="hover:border-accent border-b-4 border-transparent px-1 py-2 text-xl text-slate-800 transition-all duration-100"
				>About</HeaderLink
			>
			<div class="relative" x-data="{ isOpen: false }">
				<button
					@click="isOpen = !isOpen"
					class="hover:border-accent border-b-4 border-transparent px-1 py-2 text-xl text-slate-800 transition-all duration-100"
					aria-label="View GRC resources"
					aria-haspopup="true"
					:aria-expanded="isOpen"
					aria-controls="resources-dropdown"
				>
					Resources
					<Icon
						name="mdi:chevron-down"
						class="inline-block h-5 w-5 transition-transform duration-200"
						:class="isOpen ? 'rotate-180' : ''"
					/>
				</button>
				<!-- Clicking ESC key should close the dropdown -->
				<div
					id="resources-dropdown"
					x-show="isOpen"
					@click.away="isOpen = false"
					@keydown.escape.window="isOpen = false"
					x-transition:enter="transition ease-out duration-200"
					x-transition:enter-start="opacity-0 transform -translate-y-2"
					x-transition:enter-end="opacity-100 transform translate-y-0"
					x-transition:leave="transition ease-in duration-150"
					x-transition:leave-start="opacity-100 transform translate-y-0"
					x-transition:leave-end="opacity-0 transform -translate-y-2"
					class="absolute right-0 mt-2 w-[fit-content] bg-white px-4 shadow-md"
				>
					<a
						href="/resources/health-wellness"
						class="block px-4 py-2 text-slate-800 hover:bg-slate-200"
						aria-label="View Health & Wellness resources">Health & Wellness</a
					>
					<a
						href="/resources/housing"
						class="block px-4 py-2 text-slate-800 hover:bg-slate-200"
						aria-label="View Housing resources">Housing</a
					>
					<a
						href="/resources/continuing-education"
						class="block px-4 py-2 text-slate-800 hover:bg-slate-200"
						aria-label="View Continuing Education resources">Continuing Education</a
					>
					<a
						href="/resources/scholarships-bursaries-awards"
						class="block px-4 py-2 text-slate-800 hover:bg-slate-200"
						aria-label="View Scholarships/Bursaries/Awards resources">Scholarships/Bursaries/Awards</a
					>
					<a
						href="/resources/scholarship-award-grant-application-support"
						class="block px-4 py-2 text-slate-800 hover:bg-slate-200"
						aria-label="View Scholarship/Award/Grant Application Support resources"
						>Scholarship/Award/Grant Application Support</a
					>
					<a
						href="/resources/teaching-assistantships"
						class="block px-4 py-2 text-slate-800 hover:bg-slate-200"
						aria-label="View Teaching Assistantships resources">Teaching Assistantships</a
					>
					<a
						href="/resources/career-planning-exploration"
						class="block px-4 py-2 text-slate-800 hover:bg-slate-200"
						aria-label="View Career Planning/Exploration resources">Career Planning/Exploration</a
					>
					<a
						href="/resources/other"
						class="mb-2 block px-4 py-2 text-slate-800 hover:bg-slate-200"
						aria-label="View Other resources">Other</a
					>
				</div>
			</div>
		</div>

		<!-- Mobile menu button -->
		<button
			@click="isOpen = !isOpen"
			class="text-slate-800 md:hidden"
			aria-controls="mobile-menu"
			aria-label="Open mobile menu"
			:aria-expanded="isOpen"
		>
			<Icon name="mdi:menu" class="mx-4 h-8 w-8" />
		</button>

		<!-- Mobile menu dropdown -->
		<div
			id="mobile-menu"
			x-show="isOpen"
			@keydown.escape.window="isOpen = false"
			x-transition:leave="transition ease-in duration-150"
			x-transition:leave-start="opacity-100 transform translate-y-0"
			x-transition:leave-end="opacity-0 transform -translate-y-2"
			@click.away="isOpen = false"
			class="absolute left-0 right-0 top-full bg-white shadow-md md:hidden"
		>
			<div class="flex flex-col p-4">
				<HeaderLink
					href="/"
					class="hover:border-accent border-accent py-2 pl-4 text-xl text-slate-800 hover:bg-slate-200"
					aria-label="Go to UofT FoM GRC homepage">Home</HeaderLink
				>
				<HeaderLink
					href="/blog"
					class="hover:border-accent py-2 pl-4 text-xl text-slate-800 hover:bg-slate-200"
					aria-label="Go to UofT FoM GRC blog">Blog</HeaderLink
				>
				<HeaderLink
					href="/about"
					class="hover:border-accent py-2 pl-4 text-xl text-slate-800 hover:bg-slate-200"
					aria-label="Go to UofT FoM GRC about page">About</HeaderLink
				>
				<div x-data="{ isOpen: false }">
					<button
						@click="isOpen = !isOpen"
						class="flex w-full items-center justify-between py-2 pl-4 pr-2 text-xl text-slate-800 hover:bg-slate-200"
						aria-label="View GRC resources"
						aria-haspopup="true"
						:aria-expanded="isOpen"
						aria-controls="resources-dropdown"
					>
						Resources
						<Icon
							name="mdi:chevron-down"
							class="h-7 w-7 transition-transform duration-200"
							:class="isOpen ? 'rotate-180' : ''"
						/>
					</button>
					<div
						id="resources-dropdown"
						x-show="isOpen"
						@keydown.escape.window="isOpen = false"
						x-transition:enter="transition ease-out duration-150"
						x-transition:enter-start="opacity-0 transform translate-y-2"
						x-transition:enter-end="opacity-100 transform translate-y-0"
						x-transition:leave="transition ease-in duration-150"
						x-transition:leave-start="opacity-100 transform translate-y-0"
						x-transition:leave-end="opacity-0 transform -translate-y-2"
					>
						<a
							href="/resources/health-wellness"
							class="block py-2 pl-6 text-slate-800 hover:bg-slate-200"
							aria-label="View Health & Wellness resources">Health & Wellness</a
						>
						<a
							href="/resources/housing"
							class="block py-2 pl-6 text-slate-800 hover:bg-slate-200"
							aria-label="View Housing resources">Housing</a
						>
						<a
							href="/resources/continuing-education"
							class="block py-2 pl-6 text-slate-800 hover:bg-slate-200"
							aria-label="View Continuing Education resources">Continuing Education</a
						>
						<a
							href="/resources/scholarships-bursaries-awards"
							class="block py-2 pl-6 text-slate-800 hover:bg-slate-200"
							aria-label="View Scholarships/Bursaries/Awards resources">Scholarships/Bursaries/Awards</a
						>
						<a
							href="/resources/scholarship-award-grant-application-support"
							class="block py-2 pl-6 text-slate-800 hover:bg-slate-200"
							aria-label="View Scholarship/Award/Grant Application Support resources"
							>Scholarship/Award/Grant Application Support</a
						>
						<a href="/resources/teaching-assistantships" class="block py-2 pl-6 text-slate-800 hover:bg-slate-200"
							>Teaching Assistantships</a
						>
						<a
							href="/resources/career-planning-exploration"
							class="block py-2 pl-6 text-slate-800 hover:bg-slate-200"
							aria-label="View Career Planning/Exploration resources">Career Planning/Exploration</a
						>
						<a
							href="/resources/other"
							class="mb-2 block py-2 pl-6 text-slate-800 hover:bg-slate-200"
							aria-label="View Other resources">Other</a
						>
					</div>
				</div>
			</div>
		</div>

		<!-- Social icons -->
		<div class="hidden space-x-4 md:flex">
			<a href="/" target="_blank" class="text-slate-800" aria-label="Follow UofT FoM GRC on Instagram">
				<span class="sr-only">Follow UofT FoM GRC on Instagram</span>
				<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="fill-current">
					<path
						fill="currentColor"
						d="M7.8 2h8.4C19.4 2 22 4.6 22 7.8v8.4a5.8 5.8 0 0 1-5.8 5.8H7.8C4.6 22 2 19.4 2 16.2V7.8A5.8 5.8 0 0 1 7.8 2m-.2 2A3.6 3.6 0 0 0 4 7.6v8.8C4 18.39 5.61 20 7.6 20h8.8a3.6 3.6 0 0 0 3.6-3.6V7.6C20 5.61 18.39 4 16.4 4zm9.65 1.5a1.25 1.25 0 0 1 1.25 1.25A1.25 1.25 0 0 1 17.25 8A1.25 1.25 0 0 1 16 6.75a1.25 1.25 0 0 1 1.25-1.25M12 7a5 5 0 0 1 5 5a5 5 0 0 1-5 5a5 5 0 0 1-5-5a5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3a3 3 0 0 0 3 3a3 3 0 0 0 3-3a3 3 0 0 0-3-3"
					></path></svg
				>
			</a>
			<a href="/" target="_blank" class="text-slate-800" aria-label="Follow UofT FoM GRC on Twitter">
				<span class="sr-only">Follow UofT FoM GRC on Twitter</span>
				<svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" class="fill-current">
					<path
						d="M5.026 15c6.038 0 9.341-5.003 9.341-9.334 0-.14 0-.282-.006-.422A6.685 6.685 0 0 0 16 3.542a6.658 6.658 0 0 1-1.889.518 3.301 3.301 0 0 0 1.447-1.817 6.533 6.533 0 0 1-2.087.793A3.286 3.286 0 0 0 7.875 6.03a9.325 9.325 0 0 1-6.767-3.429 3.289 3.289 0 0 0 1.018 4.382A3.323 3.323 0 0 1 .64 6.575v.045a3.288 3.288 0 0 0 2.632 3.218 3.203 3.203 0 0 1-.865.115 3.23 3.23 0 0 1-.614-.057 3.283 3.283 0 0 0 3.067 2.277A6.588 6.588 0 0 1 .78 13.58a6.32 6.32 0 0 1-.78-.045A9.344 9.344 0 0 0 5.026 15z"
					></path>
				</svg>
			</a>
			<a
				href="https://github.com/UofT-FoM-GRC"
				target="_blank"
				class="text-slate-800"
				aria-label="Go to UofT FoM GRC's GitHub organization page"
			>
				<span class="sr-only">Go to UofT FoM GRC's GitHub organization page</span>
				<svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" class="fill-current">
					<path
						d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"
					></path>
				</svg>
			</a>
		</div>
	</nav>
</header>
